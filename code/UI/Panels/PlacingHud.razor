@using Sandbox;
@using Sandbox.UI;
@namespace Battlebugs
@inherits Panel
@attribute [StyleSheet]

<root>
	@if (!BoardManager.Local.IsValid()) return;

	<div class="bug-inventory">
		@if (true)
		{
			@foreach (var bugItem in BoardManager.Local.BugInventory)
			{
				<div class="bug-inventory-item">
					<div class="color" style="background-color: @bugItem.Key.Color.Hex">
						<label>x@(bugItem.Key.SegmentCount)</label>
					</div>
					<label>@bugItem.Value</label>
				</div>
			}
		}
	</div>
	<div class="footer">
		@if (GameManager.Instance.Boards.Any(x => x.IsReady))
		{
			<label>@(BoardManager.Local.IsReady ? "Waiting for opponent..." : "Opponent is ready...")</label>
		}
		<div class="buttons">
			<button class="clear-bugs" onclick=@BoardManager.Local.ClearAllBugs>Reset Bugs</button>
			<button class="ready-up" onclick=@BoardManager.Local.ToggleReady>@(BoardManager.Local.IsReady ? "Un-Ready" : "Ready")</button>
		</div>
	</div>
</root>

@code
{
	protected override int BuildHash() => System.HashCode.Combine(BoardManager.Local, BoardManager.Local?.BugInventory.Sum(x => x.Value), BoardManager.Local?.IsReady, GameManager.Instance.Boards.Any(x => x.IsReady));
}